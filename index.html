<script>
  const monday = window.mondaySdk();
  const selector = document.getElementById("itemSelector");
  const iframe = document.getElementById("iframeView");

  // Tu ID de columna fija
  const linkColumnId = "link_mkny9vt2";

  monday.listen("context", async res => {
    const boardId = res.data.boardId;

    // Obtener elementos del board con la columna específica
    const itemsRes = await monday.api(`query {
      boards(ids: ${boardId}) {
        items {
          id
          name
          column_values(ids: ["${linkColumnId}"]) {
            id
            text
          }
        }
      }
    }`);

    const items = itemsRes.data.boards[0].items;

    items.forEach(item => {
      const url = item.column_values[0].text;
      if (url) {
        const option = document.createElement("option");
        option.value = url;
        option.text = item.name;
        selector.appendChild(option);
      }
    });

    selector.addEventListener("change", () => {
      const url = selector.value;
      iframe.src = url.startsWith("http") ? url : "https://" + url;
    });

    // Mostrar el primero automáticamente
    if (items.length > 0) {
      const firstUrl = items[0].column_values[0].text;
      if (firstUrl) {
        selector.selectedIndex = 0;
        iframe.src = firstUrl.startsWith("http") ? firstUrl : "https://" + firstUrl;
      }
    }
  });
</script>
